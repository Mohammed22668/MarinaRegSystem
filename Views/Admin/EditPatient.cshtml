@model MarinaRegSystem.Models.Patient



@{
    Layout = "_LayoutAdmin";
    ViewData["Title"] = "تعديل ملف مريض";
}

@section Head {

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <link rel="shortcut icon" type="image/x-icon" href="~/assets/img/favicon.png">
        <title>مستشفى مارينا - الرئيسية</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" type="text/css" href="~/assets/css/bootstrap.rtl.min.css">

        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="~/assets/plugins/fontawesome/css/fontawesome.min.css">
        <link rel="stylesheet" href="~/assets/plugins/fontawesome/css/all.min.css">

        <!-- Select2 CSS -->
        <link rel="stylesheet" type="text/css" href="~/assets/css/select2.min.css">

        <!-- Datatables CSS -->
        <link rel="stylesheet" href="~/assets/plugins/datatables/datatables.min.css">

        <!-- Feathericon CSS -->
        <link rel="stylesheet" href="~/assets/css/feather.css">

        <!-- Main CSS -->
        <link rel="stylesheet" type="text/css" href="~/assets/css/style.css">


        <style>
            .table th {
                background-color: #f1f4f7;
                color: #3b3f5c;
                font-weight: bold;
                text-align: center;
                vertical-align: middle;
            }

            .table td {
                text-align: center;
                vertical-align: middle;
            }

            .table-avatar a {
                display: flex;
                align-items: center;
                gap: 10px;
                text-decoration: none;
            }

            .table-avatar img {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                object-fit: cover;
            }

            .rating i {
                font-size: 1rem;
            }

            .actions .btn {
                padding: 5px 10px;
                font-size: 0.85rem;
                border-radius: 6px;
            }

            .bg-success-light {
                background-color: #d4edda;
                color: #155724;
            }

            .bg-danger-light {
                background-color: #f8d7da;
                color: #721c24;
            }

            .btn-primary i {
                margin-left: 5px;
            }

            .page-title {
                font-weight: 700;
                color: #3b3f5c;
                font-size: 1.75rem;
            }

            .badge {
                font-size: 0.85rem;
                padding: 6px 12px;
                border-radius: 50px;
            }
        </style>

    </head>
}

@section currentPage {
    <li class="menu-side"><img src="~/assets/img/icons/menu-icon-04.svg" alt=""></li>
    <li class="breadcrumb-item" style="vertical-align:middle;margin-right:10px"><a href="#" style="font-weight:bolder">تعديل
            ملف مريض</a></li>
}


<div class="container mt-5">
    <form asp-action="EditPatient" method="post" novalidate>
        <input type="hidden" asp-for="Id" />

        <div class="row g-4">
            <!-- العمود الأول -->
            <div class="col-md-6">
                <h5 class="mb-3 text-primary fw-bold border-start border-4 border-primary ps-3">معلومات الاسم والهوية
                </h5>

                <div class="mb-3">
                    <label asp-for="FirstName" class="form-label fw-semibold"></label>
                    <input asp-for="FirstName" class="form-control form-control-lg" />
                    <span asp-validation-for="FirstName" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="SecondName" class="form-label fw-semibold"></label>
                    <input asp-for="SecondName" class="form-control form-control-lg" />
                    <span asp-validation-for="SecondName" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="ThirdName" class="form-label fw-semibold"></label>
                    <input asp-for="ThirdName" class="form-control form-control-lg" />
                    <span asp-validation-for="ThirdName" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="FourthName" class="form-label fw-semibold"></label>
                    <input asp-for="FourthName" class="form-control form-control-lg" />
                    <span asp-validation-for="FourthName" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="EnglishFullName" class="form-label fw-semibold"></label>
                    <input asp-for="EnglishFullName" class="form-control form-control-lg" />
                </div>

                <div class="row g-3">
                    <div class="col-md-6">
                        <label asp-for="DateOfBirth" class="form-label fw-semibold"></label>
                        <input asp-for="DateOfBirth" class="form-control form-control-lg" type="date" />
                        <span asp-validation-for="DateOfBirth" class="text-danger small"></span>
                    </div>

                    <div class="col-md-6">
                        <label asp-for="Age" class="form-label fw-semibold"></label>
                        <input asp-for="Age" class="form-control form-control-lg" />
                    </div>
                </div>

                <div class="mb-3 mt-3">
                    <label asp-for="Gender" class="form-label fw-semibold"></label>
                    <select asp-for="Gender" class="form-select form-select-lg">
                        <option value="">-- اختر --</option>
                        <option value="ذكر">ذكر</option>
                        <option value="أنثى">أنثى</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="PhoneNumber" class="form-label fw-semibold"></label>
                    <input asp-for="PhoneNumber" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="NationalNumber" class="form-label fw-semibold"></label>
                    <input asp-for="NationalNumber" class="form-control form-control-lg" />
                    <span asp-validation-for="NationalNumber" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="PassportNumber" class="form-label fw-semibold"></label>
                    <input asp-for="PassportNumber" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="InsuranceNumber" class="form-label fw-semibold"></label>
                    <input asp-for="InsuranceNumber" class="form-control form-control-lg" />
                </div>
            </div>

            <!-- العمود الثاني -->
            <div class="col-md-6">
                <h5 class="mb-3 text-primary fw-bold border-start border-4 border-primary ps-3">معلومات العنوان والحالة
                    الصحية</h5>

                <div class="mb-3">
                    <label asp-for="Country" class="form-label fw-semibold"></label>
                    <input asp-for="Country" class="form-control form-control-lg" />
                    <span asp-validation-for="Country" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Province" class="form-label fw-semibold"></label>
                    <input asp-for="Province" class="form-control form-control-lg" />
                    <span asp-validation-for="Province" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="City" class="form-label fw-semibold"></label>
                    <input asp-for="City" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="Neighborhood" class="form-label fw-semibold"></label>
                    <input asp-for="Neighborhood" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="Address" class="form-label fw-semibold">اقرب نقطة دالة</label>
                    <input asp-for="Address" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="BloodType" class="form-label fw-semibold"></label>
                    <select asp-for="BloodType" class="form-select form-select-lg">
                        <option value="">-- اختر --</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                    <span asp-validation-for="BloodType" class="text-danger small"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="Allergies" class="form-label fw-semibold"></label>
                    <input asp-for="Allergies" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="ChronicDiseases" class="form-label fw-semibold"></label>
                    <input asp-for="ChronicDiseases" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="Symptoms" class="form-label fw-semibold"></label>
                    <input asp-for="Symptoms" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="MenstrualCycleDuration" class="form-label fw-semibold"></label>
                    <input asp-for="MenstrualCycleDuration" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="Height" class="form-label fw-semibold"></label>
                    <input asp-for="Height" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="Weight" class="form-label fw-semibold"></label>
                    <input asp-for="Weight" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="ClosePerson" class="form-label fw-semibold"></label>
                    <input asp-for="ClosePerson" class="form-control form-control-lg" />
                </div>

                <div class="mb-3">
                    <label asp-for="AdditionalNotes" class="form-label fw-semibold"></label>
                    <textarea asp-for="AdditionalNotes" rows="3" class="form-control form-control-lg"></textarea>
                </div>
            </div>
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary btn-lg px-5">حفظ التعديلات</button>
            <a asp-action="ListPatients" class="btn btn-outline-secondary btn-lg ms-3">عودة</a>
        </div>
    </form>
</div>


@section Scripts {
    <script>
        function calculateAgeFromDOB(dobStr) {
            const dob = new Date(dobStr);
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const m = today.getMonth() - dob.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            return age;
        }

        function calculateDOBFromAge(age) {
            const today = new Date();
            const year = today.getFullYear() - age;
            return `${year}-07-01`; // يوم 1 شهر 7 للسنة المحسوبة
        }

        document.addEventListener("DOMContentLoaded", function () {
            const dobInput = document.getElementById("DateOfBirth");
            const ageInput = document.getElementById("Age");

            if (!dobInput || !ageInput) return;

            // عند تغيير تاريخ الميلاد => حساب العمر
            dobInput.addEventListener("change", function () {
                const age = calculateAgeFromDOB(this.value);
                if (!isNaN(age)) {
                    ageInput.value = age;
                }
            });

            // عند تغيير العمر => حساب تاريخ الميلاد
            ageInput.addEventListener("input", function () {
                const age = parseInt(this.value);
                if (!isNaN(age) && age >= 0) {
                    dobInput.value = calculateDOBFromAge(age);
                }
            });
        });
    </script>
}



@section Footer {
    <!-- jQuery -->
    <script src="~/assets/js/jquery-3.7.1.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="~/assets/js/bootstrap.bundle.min.js"></script>

    <!-- Feather Js -->
    <script src="~/assets/js/feather.min.js"></script>

    <!-- Slimscroll -->
    <script src="~/assets/js/jquery.slimscroll.js"></script>

    <!-- Select2 Js -->
    <script src="~/assets/js/select2.min.js"></script>

    <!-- Datepicker JS -->
    <script src="~/assets/plugins/moment/moment.min.js"></script>
    <script src="~/assets/js/bootstrap-datetimepicker.min.js"></script>

    <!-- Custom JS -->
    <script src="~/assets/js/script.js"></script>

    <!-- Validation Scripts -->
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
}